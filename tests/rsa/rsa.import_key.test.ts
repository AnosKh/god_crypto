import { RSA } from "./../../rsa.ts";
import {
  assertEquals,
} from "https://deno.land/std@0.63.0/testing/asserts.ts";

Deno.test("RSA - Import JWK Public Key", () => {
  const jwk = {
    "e": "AQAB",
    "alg": "RS256",
    "use": "sig",
    "n":
      "7NfiTQcshWgrEdKbHC2e1s92kK-YX7jS3JLFIBpT8f_j_b5y3dQdtFFS4vBoVNQkwep_34x_ihYlhA3QkwaTL2XMSiedjLnubFZBUjs7G0dgGIR3F8A06Bf5KT4g2x1dKVb0Lwwqg22XIfqaS88HdU5pDwcVmq4pVMaJQgUK-xFEC_sHdfqTV8Z0uBCr9Nik_7xz68FINDYyLhehnvwph9ui-8_WeDgU_h5xrG8H7oY28y2NCtBwXxIadB-K8pHxK2srM8wTCIivdyZS80P0jZMqyxPkt4fO33-GQWvelVmR0bS4Arb3Y4bXnoAMCEao3DTm0bgeNVz39274ippJSQ",
    "kty": "RSA",
    "kid": "0a7dc12664590c957ffaebf7b6718297b864ba91",
  };

  const key = RSA.importKey(jwk);
  assertEquals(
    key.n,
    29898696334083768896266718702903171091859023056380305309417814312144807651236219776572988301924887627930068177446780412276940629516142064593112933354190594654697661829130606057587381851965706738909234655495626384372595795359236395774819608658749454999590004164863045288407450035910884781406353708688482649485901718330442366762092993760752462641504190676097552830866364434725980527790004239511223633036676476183317655075621501198026388523929916443949606011158134681907852424177605535928134115519418874993982126227290991413378693772648195647359413482755806577610702326142298069698977819919395238440777867763969032866121n,
  );
  assertEquals(key.e, 65537n);
  assertEquals(key.length, 256);
});
